machine:
  timezone:
    Asia/Tokyo

dependencies:
  cache_directories:
    - ~/bin
  pre:
    - mkdir -p ~/bin
    - if [ ! -f ~/bin/bazel-ecd4ec4 ]; then cd && wget https://storage.googleapis.com/archive-imoz-jp/Repository/Bazel/bazel-ecd4ec4.tar.xz && tar -Jxvf bazel-*.tar.xz && cd bazel && ./compile.sh build ~/bin/bazel-ecd4ec4 && ln -s bazel-ecd4ec4 ~/bin/bazel; fi
  override:
    - ~/bazel/output/bazel build //...

test:
  override:
    - ~/bazel/output/bazel test //...
